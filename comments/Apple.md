Apple.tsx

–≠—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `Apple` –≤ React —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `@react-three/fiber` –∏ `@react-three/drei` —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ 3D-–º–æ–¥–µ–ª–∏ —è–±–ª–æ–∫–∞ (–ø–∏—â–∏ –¥–ª—è –∑–º–µ–π–∫–∏). –í–æ—Ç –µ–≥–æ **–æ–ø–∏—Å–∞–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞**:

---

### üîç **–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞**

#### üì¶ –ò–º–ø–æ—Ä—Ç—ã:

- `useGLTF` ‚Äì –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ `.glb` 3D-–º–æ–¥–µ–ª–∏ —è–±–ª–æ–∫–∞.
    
- `getField` ‚Äì –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è.
    
- `useFrame` ‚Äì –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä (–∞–Ω–∞–ª–æ–≥ `requestAnimationFrame`).
    
- `getFoodCoord` ‚Äì —Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è —Ç–µ–∫—É—â—É—é –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É –µ–¥—ã.
    
- `getFoodEaten` ‚Äì –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –≤–µ—Ä–æ—è—Ç–Ω–æ–π –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏ —è–±–ª–æ–∫–∞ –ø—Ä–∏ —Å—ä–µ–¥–∞–Ω–∏–∏.
    

#### üçè –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `Apple`:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏:**
    
    ```ts
    const { scene } = useGLTF('/apple.glb')
    ```
    
    –ú–æ–¥–µ–ª—å —è–±–ª–æ–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑.
    
2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –µ–¥—ã:**
    
    ```ts
    const [foodPosition, setFoodPosition] = React.useState<Vector3>([0, 0, 0.5])
    ```
    
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –µ–¥—ã –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä:**
    
    ```ts
    useFrame(() => {
      const updatedPosition = getFoodCoord()
      ...
      setFoodPosition(adjustedPosition)
    })
    ```
    
    –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å **–ø–µ—Ä–µ–∏–∑–±—ã—Ç–æ—á–Ω–æ**, –µ—Å–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä ‚Äî –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –ª–∏—à–Ω–∏–µ —Ä–µ—Ä–µ–Ω–¥–µ—Ä—ã. –õ—É—á—à–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ—Ç–¥–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–∞.
    
4. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–Ω–µ–π:**
    
    ```ts
    scene.traverse((node) => {
      if ('isMesh' in node) {
        node.castShadow = true
      }
    })
    ```
    
    –≠—Ç–æ —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ ‚Äî –¥–µ–ª–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –≤ `useEffect`.
    
5. **–†–µ–Ω–¥–µ—Ä —è–±–ª–æ–∫–∞:**
    
    ```ts
    return <primitive object={scene} position={foodPosition} scale={0.3} />
    ```
    

---

### ‚úÖ **–ü–ª—é—Å—ã:**

- üëç –ß–∏—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Ö–æ—Ä–æ—à–æ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏.
    
- üëç –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `useGLTF`, `useFrame` –∏ `useEffect` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
    
- üëç –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–Ω–µ–π (`castShadow`) ‚Äî —Ö–æ—Ä–æ—à–æ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.
    

---

### ‚ö†Ô∏è **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ / –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

1. **–ù–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä:**
    
    ```ts
    useFrame(() => {
      ...
      setFoodPosition(...)
    })
    ```
    
    üîß –õ—É—á—à–µ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É: –µ—Å–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å `state`.
    
    ```ts
    useFrame(() => {
      const updatedPosition = getFoodCoord()
      const adjustedX = Math.round(updatedPosition[0] - fieldSize / 2 - 1)
      const adjustedY = Math.round(updatedPosition[1] - fieldSize / 2 - 1)
      const adjustedPosition: Vector3 = [adjustedX, adjustedY, 0.5]
    
      setFoodPosition((prev) =>
        prev[0] !== adjustedPosition[0] || prev[1] !== adjustedPosition[1]
          ? adjustedPosition
          : prev
      )
    })
    ```
    
2. **`getFoodEaten()` –≤ `useEffect` –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –Ω–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞:**
    
    ```ts
    useEffect(() => { ... }, [scene, getFoodEaten()])
    ```
    
    –§—É–Ω–∫—Ü–∏—è `getFoodEaten()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º/—Å—Å—ã–ª–∫–æ–π. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ `useMemo` –∏–ª–∏ `useCallback`), —á—Ç–æ –≤—ã–∑–æ–≤–µ—Ç –ª–∏—à–Ω–∏–µ –≤—ã–∑–æ–≤—ã `useEffect`. –õ—É—á—à–µ —É–¥–∞–ª–∏—Ç—å –µ—ë –∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏–ª–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ —á–µ—Ä–µ–∑ –ø–æ–¥–ø–∏—Å–∫—É.
    
3. **–ù–µ—Ç `useMemo` –¥–ª—è –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –ø–æ–∑–∏—Ü–∏–∏ ‚Äî –≤–æ–∑–º–æ–∂–Ω—ã –ª–∏—à–Ω–∏–µ —Ä–µ—Ä–µ–Ω–¥–µ—Ä—ã.**
    

---

### üß† –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–•–æ—Ä–æ—à–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ 3D-–æ–±—ä–µ–∫—Ç–∞ –Ω–∞ –∏–≥—Ä–æ–≤–æ–º –ø–æ–ª–µ. –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –Ω–æ:

- –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ **–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å `useFrame`**,
    
- –∏ **–ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `useEffect`**, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –ª–∏—à–Ω–∏—Ö –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤.
    

---

### üîß –†–µ–π—Ç–∏–Ω–≥: **8.5 / 10**

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–æ–≥—É —Å—Ä–∞–∑—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —É–ª—É—á—à–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞.