Grid.tsx

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `Grid` ‚Äî —ç—Ç–æ —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–π React-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π —Å–µ—Ç–∫–∏ (`GridHelper`) –∏–∑ `three.js` –≤ —Å—Ü–µ–Ω—É. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–ª–∏ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å—Ç–∏–ª–µ "–ó–º–µ–π–∫–∏" –∏–ª–∏ RTS-–∏–≥—Ä). –ù–∞–ø–∏—Å–∞–Ω –æ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–π –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏.

---

### üîç **–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞**

```tsx
import * as THREE from 'three'
import { useThree } from '@react-three/fiber'
import { useEffect, useRef } from 'react'
import { fieldCONFIG } from '../config/fieldConfig'
import { getField } from '../engine/field/fieldPerLevel'

export const Grid = () => {
  const {
    fieldCOLOR: fieldColor,
    fieldRATIO: fieldRatio,
  } = fieldCONFIG

  const fieldSize = getField()
  const { scene } = useThree()
  const gridRef = useRef<THREE.GridHelper | null>(null)

  useEffect(() => {
    const resolution = new THREE.Vector2(fieldSize, fieldSize)

    const gridHelper = new THREE.GridHelper(
      resolution.x,
      resolution.y,
      0xffffff, // —Ü–≤–µ—Ç –≥–ª–∞–≤–Ω—ã—Ö –ª–∏–Ω–∏–π
      0xffffff  // —Ü–≤–µ—Ç –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã—Ö –ª–∏–Ω–∏–π
    )

    gridHelper.position.set(0, 0, 0.1)
    gridHelper.rotation.x = Math.PI / 2
    gridHelper.material.transparent = true
    gridHelper.material.opacity = 0.3

    scene.add(gridHelper)
    gridRef.current = gridHelper

    // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
    return () => {
      scene.remove(gridHelper)
      gridHelper.geometry.dispose()
      if (Array.isArray(gridHelper.material)) {
        gridHelper.material.forEach((m) => m.dispose())
      } else {
        gridHelper.material.dispose()
      }
    }
  }, [scene, fieldSize])

  return null
}
```

---

### ‚úÖ **–ü–ª—é—Å—ã**

- ‚úÖ **–ü—Ä—è–º–∞—è —Ä–∞–±–æ—Ç–∞ —Å `three.js` API** —á–µ—Ä–µ–∑ `useThree()` ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–± –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω—É.
    
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–≤–æ—Ä–æ—Ç —Å–µ—Ç–∫–∏** –¥–ª—è 2D-–≤–∏–¥–∞ —Å–≤–µ—Ä—Ö—É (`rotation.x = œÄ/2`).
    
- ‚úÖ **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏** ‚Äî —É–¥–æ–±–Ω–æ –¥–ª—è –Ω–µ–Ω–∞–≤—è–∑—á–∏–≤–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.
    
- ‚úÖ **–†–µ—Ñ–µ—Ä–µ–Ω—Å —á–µ—Ä–µ–∑ `useRef`** –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ –¥–∞–ª—å–Ω–µ–π—à–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ (`scene.remove`, –∏ —Ç.–¥.).
    

---

### ‚ö†Ô∏è **–ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å**

1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤:**
    
    - –°–µ–π—á–∞—Å `GridHelper` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è, –Ω–æ –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ —Å—Ü–µ–Ω—ã –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è—Ö –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å _—É—Ç–µ—á–∫—É –ø–∞–º—è—Ç–∏_ –∏ _–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∫–∏_. ‚õî
        
    - –î–æ–±–∞–≤—å `return () => scene.remove(gridHelper)` –∏ `dispose()` —Ä–µ—Å—É—Ä—Å–∞ (–∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ).
        
2. **–ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞:**
    
    - –¶–≤–µ—Ç–∞ –∑–∞–¥–∞–Ω—ã —Ö–∞—Ä–¥–∫–æ–¥–æ–º `0xffffff`. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑ `fieldCONFIG`, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Ü–≤–µ—Ç –ø–æ–ª—è:
        
    
    ```tsx
    fieldColorSecondary || 0xffffff
    ```
    
3. **UI-–ø—É—Å—Ç—ã—à–∫–∞ (`return <></>`):**
    
    - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `null`, —á—Ç–æ –ª–æ–≥–∏—á–Ω–æ, –Ω–æ –º–æ–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å `return null` –≤–º–µ—Å—Ç–æ JSX-—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ ‚Äî –ª—É—á—à–µ —á–∏—Ç–∞–µ—Ç—Å—è.
        
4. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å:**
    
    - –ú–æ–∂–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø—Ä–æ–ø—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `color`, `opacity`, `size`, `visible`) –¥–ª—è –±–æ–ª–µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
        
    
    ```tsx
    export const Grid = ({
      color = 0xffffff,
      opacity = 0.3,
      visible = true,
    }) => { ... }
    ```
    

---

### üß† **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `Grid` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é –∑–∞–¥–∞—á—É ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–µ—Ç–∫—É –Ω–∞ –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ. –û–Ω –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑–º–µ—Ç–∫–∏. –û–¥–Ω–∞–∫–æ, –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –æ—á–∏—Å—Ç–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –Ω–µ–º–Ω–æ–≥–æ –≥–∏–±–∫–æ—Å—Ç–∏.

---

### üîß **–û—Ü–µ–Ω–∫–∞: 8.8 / 10**

‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ  
‚ö† –¢—Ä–µ–±—É–µ—Ç—Å—è `scene.remove()` –∏ `dispose()`  
üí° –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ.

–•–æ—á–µ—à—å ‚Äî –º–æ–≥—É –ø—Ä–∏—Å–ª–∞—Ç—å –≤–µ—Ä—Å–∏—é —Å –ø–æ–ª–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ–±—ä–µ–∫—Ç–∞ –∏ –ø—Ä–æ–ø—Å–∞–º–∏.